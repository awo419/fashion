<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lagos Fashion | Modern African Wear</title>
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        /* --- CSS Reset & Variables --- */
        :root {
            /* Luxury Monochrome & Gold Palette */
            --primary: #000000; /* Deep Black */
            --primary-hover: #333333; /* Dark Charcoal */
            --secondary: #111111; /* Off Black */
            --accent: #C5A059; /* Heritage Gold */
            --accent-light: #F4F1EA; /* Warm Beige Background */
            
            --bg-light: #ffffff;
            --bg-off-white: #fafafa;
            --text-main: #111111;
            --text-light: #666666;
            --border-color: #e5e5e5;
            --success: #065f46;
            --danger: #991b1b;
            
            --font-main: 'Lato', sans-serif;
            --font-serif: 'Playfair Display', serif;
            
            --container-width: 1280px;
            --header-height: 80px;
            --announcement-height: 40px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-main);
            color: var(--text-main);
            background-color: var(--bg-light);
            line-height: 1.6;
            overflow-x: hidden;
        }

        a { text-decoration: none; color: inherit; transition: color 0.3s; }
        a:hover { color: var(--accent); }
        ul { list-style: none; }
        button { border: none; background: none; cursor: pointer; font-family: inherit; }
        img { max-width: 100%; display: block; }

        /* --- Utility Classes --- */
        .container {
            max-width: var(--container-width);
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .font-serif { font-family: var(--font-serif); }
        .font-bold { font-weight: 700; }
        .text-primary { color: var(--primary); }
        .relative { position: relative; }
        .cursor-pointer { cursor: pointer; }

        /* --- Animations --- */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.6s ease-out forwards; }
        
        /* --- Announcement Bar (New) --- */
        .announcement-bar {
            background-color: var(--primary);
            color: white;
            height: var(--announcement-height);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            font-weight: 700;
            position: relative;
            z-index: 101;
        }

        /* --- Navigation --- */
        .navbar {
            position: fixed;
            top: var(--announcement-height);
            left: 0;
            top:0;
            width: 100%;
            height: var(--header-height);
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(10px);
            z-index: 100;
            border-bottom: 1px solid transparent;
            transition: all 0.3s ease;
        }
        .navbar.scrolled { border-bottom-color: var(--border-color); }

        .nav-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
        }

        .brand-logo {
            font-family: var(--font-serif);
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }
        .brand-logo span { color: var(--accent); } 

        .nav-links { display: flex; gap: 2.5rem; }
        .nav-links button {
            color: var(--text-main);
            font-weight: 500;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: color 0.2s;
            position: relative;
        }
        .nav-links button:hover { color: var(--accent); }
        .nav-links button.active { color: var(--primary); font-weight: 700; }
        .nav-links button.active::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--accent);
        }

        .nav-icons { display: flex; gap: 1.5rem; align-items: center; }
        .nav-icons button { color: var(--text-main); transition: color 0.2s; font-size: 1.2rem; }
        .nav-icons button:hover { color: var(--accent); }

        /* Currency Switcher */
        .currency-select {
            border: none;
            background: transparent;
            font-family: var(--font-main);
            font-weight: 700;
            font-size: 0.9rem;
            cursor: pointer;
            outline: none;
            color: var(--text-main);
        }

        /* Search Styles */
        .search-container {
            position: relative;
            display: flex;
            align-items: center;
        }
        .search-input {
            position: absolute;
            right: 0;
            width: 0;
            opacity: 0;
            padding: 0.5rem;
            border-bottom: 1px solid var(--primary);
            border-top: none; border-left: none; border-right: none;
            background: transparent;
            transition: all 0.4s ease;
            z-index: 10;
            font-family: var(--font-main);
        }
        .search-input:focus { outline: none; border-bottom-color: var(--accent); }
        .search-container.active .search-input { width: 250px; opacity: 1; right: 30px; }

        .cart-badge {
            position: absolute;
            top: -6px;
            right: -8px;
            background: var(--accent);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transform: scale(0);
            transition: transform 0.2s;
        }
        .cart-badge.active { transform: scale(1); }

        /* --- Hero Section --- */
        .hero {
            position: relative;
            height: 700px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            margin-top: calc(var(--header-height) + var(--announcement-height));
            overflow: hidden;
            background-color: #000;
        }

        .hero-bg {
            position: absolute;
            inset: 0;
            opacity: 0.7;
        }
        .hero-bg img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .hero-content {
            position: relative;
            z-index: 10;
            padding: 0 1rem;
            color: white;
            max-width: 800px;
        }

        .hero-subtitle {
            color: var(--accent);
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            display: block;
            margin-bottom: 1.5rem;
            animation: fadeIn 0.8s ease-out;
        }

        .hero-title {
            font-family: var(--font-serif);
            font-size: 4rem;
            font-weight: 400; /* Lighter weight for elegance */
            line-height: 1.1;
            margin-bottom: 2rem;
            animation: fadeIn 0.8s ease-out 0.2s forwards;
            opacity: 0;
        }

        .btn-primary {
            background-color: white;
            color: black;
            padding: 1rem 2.5rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            transition: all 0.3s;
            display: inline-block;
            border: 1px solid white;
            border-radius: 0; /* Sharp edges */
        }
        .btn-primary:hover {
            background-color: transparent;
            color: white;
        }

        /* --- Press Section --- */
        .press-section {
            background-color: var(--bg-off-white);
            padding: 3rem 0;
            border-bottom: 1px solid var(--border-color);
        }
        .press-text { text-align: center; font-size: 0.75rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--text-light); margin-bottom: 1.5rem; }
        .press-logos {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3rem;
            flex-wrap: wrap;
            opacity: 0.6;
        }
        .press-logo { font-family: 'Playfair Display', serif; font-size: 1.5rem; font-weight: 700; color: #333; }

        /* --- Shop Section --- */
        .shop-section { padding: 5rem 0; }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 3rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .section-title { font-size: 2.5rem; margin-bottom: 0.5rem; color: var(--primary); letter-spacing: -0.02em; }
        .live-indicator { color: var(--success); font-weight: 500; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.05em; }

        .controls-wrapper { display: flex; gap: 1rem; align-items: center; }

        .select-control {
            padding: 0.75rem 1.5rem;
            border: 1px solid var(--border-color);
            background-color: white;
            color: var(--text-main);
            outline: none;
            cursor: pointer;
            font-family: var(--font-main);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            appearance: none;
        }
        .select-control:focus { border-color: var(--primary); }

        .mobile-select { display: none; width: 100%; margin-top: 1rem; }

        /* --- Product Grid --- */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 3rem 1.5rem;
        }

        .product-card {
            position: relative;
            animation: fadeIn 0.5s ease-out;
            background: white;
            transition: transform 0.3s;
        }
        .product-card:hover { transform: translateY(-5px); }

        .product-image-wrapper {
            position: relative;
            aspect-ratio: 3 / 4; /* Editorial ratio */
            background-color: #f0f0f0;
            overflow: hidden;
            margin-bottom: 1rem;
            cursor: pointer;
        }

        .product-image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.7s ease;
        }
        
        .product-card:hover .product-image-wrapper img { transform: scale(1.03); }

        .wishlist-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            z-index: 20;
            background: white;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            transition: all 0.2s;
            border-radius: 50%;
        }
        .wishlist-btn:hover { background: var(--primary); color: white; }
        .wishlist-btn.active { color: var(--danger); }

        .badge {
            position: absolute;
            top: 1rem;
            padding: 0.4rem 0.8rem;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            z-index: 10;
            letter-spacing: 0.1em;
        }
        .badge-new { left: 1rem; background: var(--primary); color: white; }
        .badge-low { left: 1rem; top: 3.5rem; background: var(--accent); color: white; }
        
        .sold-out-overlay {
            position: absolute;
            inset: 0;
            background: rgba(255,255,255,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5;
        }
        .sold-out-text {
            background: var(--primary);
            color: white;
            padding: 0.75rem 1.5rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Stars - Gold now */
        .stars { color: var(--accent); font-size: 0.8rem; margin-bottom: 0.25rem; }
        .stars-small { font-size: 0.7rem; }

        .product-info { text-align: left; }
        
        .product-title { 
            font-family: var(--font-serif);
            font-size: 1.1rem; 
            font-weight: 600; 
            color: var(--text-main); 
            margin-bottom: 0.25rem; 
            cursor: pointer; 
        }
        .product-title:hover { color: var(--accent); }
        
        .product-cat { font-size: 0.75rem; color: var(--text-light); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; }
        .product-price { font-size: 1rem; font-weight: 700; color: var(--primary); }

        .btn-add-cart {
            width: 100%;
            margin-top: 1rem;
            padding: 0.9rem;
            border: 1px solid var(--primary);
            background: transparent;
            font-weight: 700;
            color: var(--primary);
            transition: all 0.2s;
            text-transform: uppercase;
            font-size: 0.8rem;
            letter-spacing: 0.1em;
            border-radius: 0;
        }
        .btn-add-cart:hover:not(:disabled) {
            background: var(--primary);
            color: white;
        }
        .btn-add-cart:disabled { border-color: #ccc; color: #ccc; cursor: not-allowed; }
        
        .stock-text { font-size: 0.75rem; color: var(--danger); text-align: center; margin-top: 0.5rem; font-weight: 500; }

        /* --- Recently Viewed Section (New) --- */
        .recently-viewed-section { padding: 3rem 0 5rem; border-top: 1px solid var(--border-color); }
        .recently-title { font-family: var(--font-serif); font-size: 1.5rem; margin-bottom: 2rem; color: var(--secondary); }
        .recently-grid { display: flex; gap: 1rem; overflow-x: auto; padding-bottom: 1rem; }
        .recent-card { min-width: 150px; cursor: pointer; }
        .recent-img { width: 100%; aspect-ratio: 1; object-fit: cover; background: #f4f4f4; margin-bottom: 0.5rem; }
        .recent-name { font-size: 0.8rem; font-weight: 700; }
        .recent-price { font-size: 0.8rem; color: var(--text-light); }

        /* --- Heritage Section --- */
        .heritage-section {
            display: flex;
            flex-direction: column;
            background-color: #fff;
            margin-top: 4rem;
        }
        @media (min-width: 768px) { .heritage-section { flex-direction: row; height: 600px; } }
        
        .heritage-img { flex: 1; position: relative; background-color: #f4f4f4; min-height: 300px; }
        .heritage-img img { width: 100%; height: 100%; object-fit: cover; }
        
        .heritage-content {
            flex: 1;
            padding: 4rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            background-color: #fff;
        }
        @media (min-width: 768px) { .heritage-content { padding: 6rem; } }
        
        .heritage-label {
            color: var(--accent);
            font-weight: 700;
            font-size: 0.85rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            margin-bottom: 2rem;
            display: block;
        }
        
        .heritage-heading {
            font-family: var(--font-serif);
            font-size: 3rem;
            line-height: 1.1;
            margin-bottom: 2rem;
            color: var(--primary);
        }
        @media (min-width: 768px) { .heritage-heading { font-size: 4rem; } }
        
        .heritage-text { color: var(--text-light); font-size: 1.1rem; line-height: 1.8; max-width: 500px; }

        /* --- Lookbook Section --- */
        .lookbook-section { padding: 6rem 0; background: var(--bg-off-white); }
        .lookbook-header { text-align: center; margin-bottom: 4rem; }
        .lookbook-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1.5rem; }
        @media(min-width: 768px) { .lookbook-grid { grid-template-columns: repeat(4, 1fr); } }
        
        .lookbook-item { aspect-ratio: 3/4; overflow: hidden; position: relative; }
        .lookbook-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; grayscale: 20%; }
        .lookbook-item:hover img { transform: scale(1.05); grayscale: 0%; }
        .lookbook-overlay { 
            position: absolute; inset: 0; background: rgba(0,0,0,0.4); opacity: 0; transition: opacity 0.3s; 
            display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase;
        }
        .lookbook-item:hover .lookbook-overlay { opacity: 1; }

        /* --- Journal Section --- */
        .journal-section { padding: 5rem 0; }
        .journal-grid { display: grid; grid-template-columns: 1fr; gap: 2rem; }
        @media(min-width: 768px) { .journal-grid { grid-template-columns: repeat(3, 1fr); } }
        
        .journal-card { cursor: pointer; }
        .journal-img { aspect-ratio: 16/10; background: #f0f0f0; margin-bottom: 1rem; overflow: hidden; }
        .journal-img img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s; }
        .journal-card:hover .journal-img img { transform: scale(1.05); }
        .journal-meta { font-size: 0.75rem; text-transform: uppercase; color: var(--accent); font-weight: 700; letter-spacing: 0.1em; margin-bottom: 0.5rem; }
        .journal-title { font-family: var(--font-serif); font-size: 1.5rem; margin-bottom: 0.5rem; line-height: 1.2; }
        .journal-excerpt { color: var(--text-light); font-size: 0.9rem; line-height: 1.6; }

        /* --- Testimonial Section --- */
        .testimonial-section {
            padding: 6rem 0;
            background-color: #fff;
            text-align: center;
        }
        .testimonial-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 3rem;
            margin-top: 3rem;
        }
        @media(min-width: 768px) { .testimonial-grid { grid-template-columns: repeat(3, 1fr); } }
        
        .testimonial-card { padding: 2rem; background: var(--bg-off-white); border: 1px solid transparent; transition: all 0.3s; }
        .testimonial-card:hover { border-color: var(--border-color); transform: translateY(-5px); }
        .testimonial-quote { font-family: var(--font-serif); font-size: 1.25rem; line-height: 1.6; margin-bottom: 1.5rem; color: var(--secondary); font-style: italic; }
        .testimonial-author { font-size: 0.8rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--accent); }

        /* --- FAQ Section --- */
        .faq-section {
            padding: 5rem 0;
            background-color: white;
            border-top: 1px solid var(--border-color);
        }
        .faq-wrapper { max-width: 800px; margin: 0 auto; }
        .faq-item { border-bottom: 1px solid var(--border-color); }
        .faq-question {
            width: 100%;
            text-align: left;
            padding: 1.5rem 0;
            font-family: var(--font-serif);
            font-size: 1.2rem;
            font-weight: 400;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .faq-question:hover { color: var(--accent); }
        .faq-answer {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        .faq-answer.open { max-height: 200px; padding-bottom: 1.5rem; }

        /* --- Features Section --- */
        .features-section {
            background-color: var(--bg-off-white);
            padding: 5rem 0;
            border-top: 1px solid var(--border-color);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
            gap: 2rem;
        }
        @media(min-width: 768px) { .features-grid { grid-template-columns: repeat(3, 1fr); } }
        
        .feature-card {
            padding: 2rem;
            text-align: center;
            border: 1px solid transparent;
            transition: all 0.3s;
        }
        .feature-card:hover { border-color: var(--border-color); }
        .feature-icon { font-size: 2rem; color: var(--primary); margin-bottom: 1.5rem; display: inline-block; }
        .feature-card h3 { font-family: var(--font-serif); font-size: 1.25rem; margin-bottom: 0.5rem; }

        /* --- Footer --- */
        footer { background: var(--primary); color: white; padding: 6rem 0 2rem; font-family: var(--font-main); }
        .footer-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 4rem;
            margin-bottom: 5rem;
        }
        @media(min-width: 768px) { .footer-grid { grid-template-columns: 2fr 1fr 1fr; } }
        
        .footer-logo {
            font-family: var(--font-serif);
            font-size: 2.2rem;
            font-weight: 700;
            color: white;
            margin-bottom: 1.5rem;
            display: block;
            letter-spacing: 0.5px;
        }
        .footer-desc {
            color: #9ca3af;
            font-size: 1rem;
            line-height: 1.7;
            margin-bottom: 2.5rem;
            max-width: 450px;
        }
        
        .social-buttons { display: flex; gap: 1rem; }
        .social-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 700;
            color: white;
            transition: all 0.3s;
            text-transform: uppercase;
        }
        .social-btn:hover { background: white; color: var(--primary); transform: translateY(-3px); }

        .footer-col h4 { 
            font-size: 0.85rem; 
            font-weight: 700; 
            margin-bottom: 2rem; 
            color: white; 
            text-transform: uppercase; 
            letter-spacing: 0.15em; 
        }
        .footer-links { display: flex; flex-direction: column; gap: 1.2rem; }
        .footer-links a { 
            color: #9ca3af; 
            font-size: 0.95rem; 
            transition: color 0.2s; 
            text-decoration: none;
        }
        .footer-links a:hover { color: white; }

        .footer-bottom {
            border-top: 1px solid #333;
            padding-top: 2.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            color: #4b5563;
            font-size: 0.85rem;
            gap: 1rem;
        }
        @media(min-width: 768px) { .footer-bottom { flex-direction: row; } }
        
        .footer-bottom-links { display: flex; gap: 2rem; }
        .footer-bottom-links a { transition: color 0.2s; }
        .footer-bottom-links a:hover { color: white; }

        /* --- Cart & Wishlist Sidebars --- */
        .cart-overlay, .wishlist-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            z-index: 140;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s;
        }
        .cart-overlay.open, .wishlist-overlay.open { opacity: 1; visibility: visible; }

        .cart-sidebar, .wishlist-sidebar {
            position: fixed;
            top: 0;
            right: 0;
            height: 100%;
            width: 100%;
            max-width: 450px;
            background: white;
            z-index: 150;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex;
            flex-direction: column;
        }
        .cart-sidebar.open, .wishlist-sidebar.open { transform: translateX(0); }

        .cart-header {
            padding: 2rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .cart-header h2 { font-family: var(--font-serif); font-size: 1.5rem; }
        
        .cart-items, .wishlist-items { flex: 1; overflow-y: auto; padding: 2rem; }
        .empty-cart-msg { text-align: center; color: var(--text-light); margin-top: 4rem; }
        
        .cart-item, .wishlist-item {
            display: flex;
            padding-bottom: 1.5rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            animation: fadeIn 0.3s;
        }
        .cart-item-img, .wishlist-item-img {
            width: 5rem;
            height: 6.5rem;
            background: #f4f4f4;
            flex-shrink: 0;
        }
        .cart-item-img img, .wishlist-item-img img { width: 100%; height: 100%; object-fit: cover; }
        .cart-item-details, .wishlist-item-details { margin-left: 1.5rem; flex: 1; display: flex; flex-direction: column; }
        
        .qty-controls {
            display: flex;
            align-items: center;
            border: 1px solid var(--border-color);
            width: fit-content;
            margin-top: auto;
        }
        .qty-btn { padding: 0.2rem 0.6rem; color: var(--text-main); font-size: 0.9rem; }
        .qty-btn:hover { background: #f3f4f6; }
        .qty-val { padding: 0 0.6rem; font-weight: 500; font-size: 0.9rem; }

        .remove-btn { color: var(--danger); font-size: 0.75rem; text-decoration: underline; margin-top: 0.5rem; display: inline-block; }

        .cart-footer { padding: 2rem; border-top: 1px solid var(--border-color); background: #fafafa; }
        .cart-subtotal { display: flex; justify-content: space-between; font-family: var(--font-serif); font-size: 1.25rem; margin-bottom: 0.5rem; }
        
        .btn-block {
            width: 100%;
            background: var(--primary);
            color: white;
            padding: 1.2rem;
            font-weight: 700;
            transition: opacity 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-size: 0.85rem;
            border-radius: 0;
        }
        .btn-block:hover:not(:disabled) { opacity: 0.9; }
        .btn-block:disabled { background: #ccc; cursor: not-allowed; }

        /* --- Modals --- */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.8);
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s;
        }
        .modal-overlay.active { opacity: 1; visibility: visible; }
        
        .modal-content {
            background: white;
            width: 100%;
            max-width: 500px;
            overflow: hidden;
            transform: translateY(20px);
            transition: transform 0.3s;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-overlay.active .modal-content { transform: translateY(0); }

        /* Product Detail Modal */
        .product-detail-modal { max-width: 1000px; display: flex; flex-direction: column; }
        @media (min-width: 768px) {
            .product-detail-modal { flex-direction: row; }
            .product-detail-img { width: 50%; }
            .product-detail-info { width: 50%; padding: 4rem; }
        }
        .product-detail-img { min-height: 400px; background: #f3f4f6; }
        .product-detail-img img { width: 100%; height: 100%; object-fit: cover; }
        .product-detail-info { padding: 2rem; display: flex; flex-direction: column; }
        
        .pd-title { font-family: var(--font-serif); font-size: 2.5rem; font-weight: 400; line-height: 1.1; margin-bottom: 0.5rem; }
        .pd-price { font-size: 1.5rem; color: var(--text-main); font-weight: 400; margin-bottom: 1.5rem; }
        .pd-desc { color: var(--text-light); margin-bottom: 2rem; line-height: 1.8; font-size: 0.95rem; }
        
        .pd-meta { display: flex; gap: 2rem; margin-bottom: 2rem; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.05em; }
        .pd-meta-item { display: flex; align-items: center; gap: 0.5rem; color: var(--text-main); }

        /* Related Products */
        .related-section { margin-top: 3rem; border-top: 1px solid var(--border-color); padding-top: 2rem; }
        .related-title { font-family: var(--font-serif); font-size: 1.25rem; margin-bottom: 1.5rem; }
        .related-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .related-card { cursor: pointer; }
        .related-img { aspect-ratio: 3/4; overflow: hidden; background: #f3f4f6; margin-bottom: 0.5rem; }
        .related-name { font-size: 0.85rem; font-weight: 700; }
        .related-price { font-size: 0.85rem; }

        /* Promo & Forms */
        .promo-container { display: flex; gap: 0; margin-bottom: 1.5rem; }
        .promo-input { flex: 1; padding: 1rem; border: 1px solid var(--border-color); outline: none; font-size: 0.9rem; }
        .promo-btn { padding: 0 1.5rem; background: var(--primary); color: white; font-weight: 700; font-size: 0.8rem; letter-spacing: 0.1em; }
        
        .form-input {
            width: 100%;
            padding: 1rem;
            border: 1px solid var(--border-color);
            outline: none;
            transition: border-color 0.2s;
            margin-bottom: 1rem;
            border-radius: 0;
        }
        .form-input:focus { border-color: var(--primary); }

        /* WhatsApp Float */
        .whatsapp-float {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #25D366;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            z-index: 99;
            transition: transform 0.3s;
        }
        .whatsapp-float:hover { transform: scale(1.1); }

        /* Back to Top */
        #back-to-top {
            position: fixed;
            bottom: 100px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: white;
            color: black;
            border: 1px solid #eee;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: opacity 0.3s, transform 0.3s;
            opacity: 0;
            pointer-events: none;
            z-index: 98;
        }
        #back-to-top.visible { opacity: 1; pointer-events: auto; }
        #back-to-top:hover { transform: translateY(-3px); }

        /* Size Guide Table */
        .size-guide-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        .size-guide-table th, .size-guide-table td { border: 1px solid #eee; padding: 12px; text-align: center; font-size: 0.9rem; }
        .size-guide-table th { background-color: #fafafa; font-weight: 700; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.1em; }

        /* Toast */
        .toast {
            visibility: hidden;
            min-width: 250px;
            background-color: var(--primary);
            color: #fff;
            text-align: center;
            padding: 1rem 2rem;
            position: fixed;
            z-index: 300;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            opacity: 0;
            transition: opacity 0.3s, bottom 0.3s;
        }
        .toast.show { visibility: visible; opacity: 1; bottom: 50px; }

        /* --- Newsletter Modal --- */
        .newsletter-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 250;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; visibility: hidden; transition: opacity 0.3s;
        }
        .newsletter-modal.active { opacity: 1; visibility: visible; }
        .newsletter-content {
            background: white; width: 90%; max-width: 600px; padding: 3rem; text-align: center;
            position: relative; border: 1px solid var(--accent);
        }
        .close-newsletter { position: absolute; top: 1rem; right: 1rem; font-size: 1.5rem; cursor: pointer; }

        /* Cookie Banner */
        .cookie-banner {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: #111; color: white;
            padding: 1.5rem; z-index: 1000;
            display: flex; justify-content: space-between; align-items: center;
            transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            border-top: 1px solid #333;
        }
        .cookie-banner.show { transform: translateY(0); }
        .cookie-text { font-size: 0.9rem; max-width: 70%; line-height: 1.5; color: #ccc; }
        .cookie-btn {
            background: var(--accent); color: black;
            padding: 0.8rem 2rem; font-weight: 700;
            text-transform: uppercase; font-size: 0.8rem;
            letter-spacing: 0.1em;
            cursor: pointer;
            transition: background 0.2s;
        }
        .cookie-btn:hover { background: white; }

        /* --- Login Modal (New) --- */
        .auth-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 300;
            display: flex; align-items: center; justify-content: center;
            opacity: 0; visibility: hidden; transition: opacity 0.3s;
        }
        .auth-modal.active { opacity: 1; visibility: visible; }
        .auth-content { background: white; width: 100%; max-width: 400px; padding: 2.5rem; position: relative; }
        .auth-tabs { display: flex; border-bottom: 1px solid #eee; margin-bottom: 2rem; }
        .auth-tab { flex: 1; text-align: center; padding: 1rem; cursor: pointer; font-weight: 700; color: #999; }
        .auth-tab.active { color: var(--primary); border-bottom: 2px solid var(--primary); }

        /* --- Media Queries --- */
        @media (min-width: 768px) {
            .nav-links { display: flex; }
            .hero-title { font-size: 5rem; }
            .features-grid { grid-template-columns: repeat(3, 1fr); }
            .footer-grid { grid-template-columns: 2fr 1fr 1fr; }
            .footer-bottom { flex-direction: row; justify-content: space-between; }
        }

        @media (max-width: 768px) {
            .nav-links { display: none; }
            .mobile-select { display: block; }
            .controls-wrapper .select-control { display: none; }
            .hero-title { font-size: 2.5rem; }
            .cookie-banner { flex-direction: column; text-align: center; gap: 1rem; }
            .cookie-text { max-width: 100%; }
        }
    </style>
</head>
<body>

    <!-- Announcement Bar -->
    <div class="announcement-bar">
        Free Worldwide Shipping on Orders Over ₦150,000
    </div>

    <!-- WhatsApp Widget -->
    <a href="https://wa.me/2348000000000" target="_blank" class="whatsapp-float" title="Chat with us">
        <i class="fa-brands fa-whatsapp"></i>
    </a>

    <!-- Back to Top Button -->
    <button id="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
        <i class="fa-solid fa-arrow-up"></i>
    </button>

    <!-- Cookie Banner -->
    <div id="cookie-banner" class="cookie-banner">
        <div class="cookie-text">
            We use cookies to enhance your experience. By continuing to visit this site you agree to our use of cookies.
        </div>
        <button class="cookie-btn" onclick="app.acceptCookies()">ACCEPT</button>
    </div>

    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="container nav-content">
            <div class="brand-logo" onclick="app.filterProducts('all')" style="cursor: pointer;">
                LAGOS<span>.FASHION</span>
            </div>

            <div class="nav-links">
                <button class="nav-link active" data-cat="all" onclick="app.filterProducts('all')">New Arrivals</button>
                <button class="nav-link" data-cat="men" onclick="app.filterProducts('men')">Men</button>
                <button class="nav-link" data-cat="women" onclick="app.filterProducts('women')">Women</button>
                <button class="nav-link" data-cat="accessories" onclick="app.filterProducts('accessories')">Accessories</button>
            </div>

            <div class="nav-icons">
                <!-- Currency Switcher -->
                <select id="currency-selector" class="currency-select" onchange="app.switchCurrency(this.value)">
                    <option value="NGN">NGN</option>
                    <option value="USD">USD</option>
                    <option value="GBP">GBP</option>
                </select>

                <!-- Search Container -->
                <div class="search-container" id="search-container">
                    <input type="text" id="search-input" class="search-input" placeholder="Search..." oninput="app.handleSearch(this.value)">
                    <button onclick="app.toggleSearch()"><i class="fa-solid fa-magnifying-glass"></i></button>
                </div>
                
                <!-- Wishlist Icon -->
                <button onclick="app.toggleWishlistSidebar()" title="Wishlist">
                    <i class="fa-regular fa-heart"></i>
                </button>

                <!-- Cart Icon -->
                <button onclick="app.toggleCart()" style="position: relative;">
                    <i class="fa-solid fa-bag-shopping"></i>
                    <span id="cart-count" class="cart-badge">0</span>
                </button>
                
                <!-- User Icon -->
                <button title="Account" onclick="app.toggleLoginModal()">
                    <i class="fa-regular fa-user"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
        <div class="hero-bg">
            <img src="https://images.unsplash.com/photo-1523824921871-d6f1a15151f1?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80" alt="African Fashion">
        </div>
        
        <div class="hero-content">
            <span class="hero-subtitle">The Heritage Collection</span>
            <h1 class="hero-title">Redefining <br> African Luxury</h1>
            <button onclick="document.getElementById('shop-section').scrollIntoView({behavior: 'smooth'})" class="btn-primary">
                Discover More
            </button>
        </div>
    </header>

    <!-- Press Section -->
    <section class="press-section">
        <div class="container">
            <p class="press-text">As Seen In</p>
            <div class="press-logos">
                <span class="press-logo">VOGUE</span>
                <span class="press-logo">Forbes Africa</span>
                <span class="press-logo">BellaNaija</span>
                <span class="press-logo">THISDAY Style</span>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main id="shop-section" class="container shop-section">
        
        <div class="section-header">
            <div>
                <h2 class="section-title font-serif">Curated Collection</h2>
                <p class="live-indicator"><span class="animate-pulse" style="margin-right: 5px; color: var(--success);">●</span> Live Inventory</p>
            </div>
            
            <div class="controls-wrapper">
                <!-- Desktop Sort -->
                <select onchange="app.handleSort(this.value)" class="select-control">
                    <option value="default">Sort by: Featured</option>
                    <option value="price-asc">Price: Low to High</option>
                    <option value="price-desc">Price: High to Low</option>
                </select>

                <!-- Mobile Category Select handled via Media Query Visibility -->
                <select onchange="app.filterProducts(this.value)" class="mobile-select select-control">
                    <option value="all">All Collections</option>
                    <option value="men">Men</option>
                    <option value="women">Women</option>
                    <option value="accessories">Accessories</option>
                </select>
            </div>
        </div>

        <div id="product-grid" class="product-grid">
            <!-- Products injected via JS -->
        </div>

    </main>

    <!-- Heritage Section -->
    <section class="heritage-section">
        <div class="heritage-img">
            <img src="https://images.unsplash.com/photo-1605218427368-35b01851839b?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80" alt="Weaving Fabric">
        </div>
        <div class="heritage-content">
            <span class="heritage-label">Our Heritage</span>
            <h2 class="heritage-heading">Made in Nigeria,<br>Worn Globally.</h2>
            <p class="heritage-text">Every piece in our collection tells a story. From the hand-dyed Adire pits of Abeokuta to the bustling tailoring workshops of Surulere, we bridge the gap between age-old tradition and modern functionality.</p>
        </div>
    </section>

    <!-- Lookbook Section -->
    <section class="lookbook-section">
        <div class="container">
            <div class="lookbook-header">
                <span style="color: var(--primary); font-weight: 700; letter-spacing: 2px; text-transform: uppercase; font-size: 0.85rem;">Community</span>
                <h2 class="font-serif" style="font-size: 2.5rem; margin-top: 0.5rem; color: var(--secondary);">As Seen On You</h2>
                <p style="color: var(--text-light); margin-top: 0.5rem;">Tag @LagosFashion to be featured.</p>
            </div>
            <div class="lookbook-grid">
                <div class="lookbook-item">
                    <img src="https://images.unsplash.com/photo-1546552356-3fae876a61ca?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Style 1">
                    <div class="lookbook-overlay">#LagosWeddings</div>
                </div>
                <div class="lookbook-item">
                    <img src="https://images.unsplash.com/photo-1552668693-d0738e00eca8?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Style 2">
                    <div class="lookbook-overlay">#OwambeReady</div>
                </div>
                <div class="lookbook-item">
                    <img src="https://images.unsplash.com/photo-1589156280159-27698a70f29e?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Style 3">
                    <div class="lookbook-overlay">#AdireVibes</div>
                </div>
                <div class="lookbook-item">
                    <img src="https://images.unsplash.com/photo-1531384441138-2736e62e0919?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Style 4">
                    <div class="lookbook-overlay">#LagosFashion</div>
                </div>
            </div>
        </div>
    </section>

    <!-- The Journal Section -->
    <section class="journal-section">
        <div class="container">
            <div class="text-center mb-10">
                <span style="color: var(--accent); font-weight: 700; letter-spacing: 0.2em; text-transform: uppercase; font-size: 0.8rem;">The Journal</span>
                <h2 class="font-serif" style="font-size: 2rem; margin-top: 0.5rem;">Stories from the Atelier</h2>
            </div>
            <div class="journal-grid">
                <div class="journal-card">
                    <div class="journal-img"><img src="https://images.unsplash.com/photo-1599692996229-79883907e890?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Blog 1"></div>
                    <div class="journal-meta">Culture • Dec 12</div>
                    <h3 class="journal-title">The Renaissance of Adire</h3>
                    <p class="journal-excerpt">How a centuries-old dyeing technique is taking over modern runways from Lagos to Paris.</p>
                </div>
                <div class="journal-card">
                    <div class="journal-img"><img src="https://images.unsplash.com/photo-1504198458649-3128b932f49e?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Blog 2"></div>
                    <div class="journal-meta">Style • Nov 28</div>
                    <h3 class="journal-title">Styling the Modern Agbada</h3>
                    <p class="journal-excerpt">Tips on how to wear the grand boubou for casual events without losing its regal essence.</p>
                </div>
                <div class="journal-card">
                    <div class="journal-img"><img src="https://images.unsplash.com/photo-1585255318859-f5c15f4cffe9?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80" alt="Blog 3"></div>
                    <div class="journal-meta">Inside • Nov 10</div>
                    <h3 class="journal-title">Meet Our Master Tailors</h3>
                    <p class="journal-excerpt">A look behind the scenes at the hands that craft your garments with precision and care.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonial Section -->
    <section class="testimonial-section">
        <div class="container">
            <h2 class="section-title font-serif text-center" style="font-size: 2rem;">Voices of Lagos</h2>
            <div class="testimonial-grid">
                <div class="testimonial-card">
                    <div class="stars">★★★★★</div>
                    <p class="testimonial-quote">"The craftsmanship on the Agbada is absolutely stunning. It feels regal and authentic."</p>
                    <span class="testimonial-author">Tolu A., Lagos</span>
                </div>
                <div class="testimonial-card">
                    <div class="stars">★★★★★</div>
                    <p class="testimonial-quote">"Ordered from London and it arrived in 4 days. The fit was perfect straight out of the box."</p>
                    <span class="testimonial-author">Sarah O., UK</span>
                </div>
                <div class="testimonial-card">
                    <div class="stars">★★★★☆</div>
                    <p class="testimonial-quote">"The customer service team on WhatsApp was so helpful in choosing the right size for my husband."</p>
                    <span class="testimonial-author">Chidinma E., Abuja</span>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section class="faq-section">
        <div class="container">
            <div class="text-center mb-10">
                <span style="color: var(--accent); font-weight: 700; letter-spacing: 0.2em; text-transform: uppercase; font-size: 0.8rem;">Concierge</span>
                <h2 class="font-serif" style="font-size: 2rem; margin-top: 0.5rem;">Frequently Asked Questions</h2>
            </div>
            <div class="faq-wrapper">
                <div class="faq-item">
                    <div class="faq-question" onclick="this.nextElementSibling.classList.toggle('open')">
                        How long does shipping take within Lagos? <span>+</span>
                    </div>
                    <div class="faq-answer">We offer next-day delivery for all orders within Lagos placed before 2 PM. Island locations may receive same-day delivery.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="this.nextElementSibling.classList.toggle('open')">
                        Do you ship internationally? <span>+</span>
                    </div>
                    <div class="faq-answer">Yes, we ship globally via DHL Express. International orders typically arrive within 3-5 business days.</div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="this.nextElementSibling.classList.toggle('open')">
                        Can I request custom measurements? <span>+</span>
                    </div>
                    <div class="faq-answer">Absolutely. Please use the WhatsApp widget to chat with our tailors for bespoke fitting requirements.</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Recently Viewed Section (New) -->
    <section class="recently-viewed-section" id="recently-viewed">
        <div class="container">
            <h3 class="recently-title">Recently Viewed</h3>
            <div id="recent-grid" class="recently-grid">
                <!-- Injected via JS -->
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section">
        <div class="container">
            <div class="features-grid">
                <div class="feature-card">
                    <i class="fa-solid fa-truck-fast feature-icon"></i>
                    <h3>Nationwide Delivery</h3>
                    <p style="color: var(--text-light); font-size: 0.9rem;">Fast shipping to Lagos, Abuja, PH, and beyond.</p>
                </div>
                <div class="feature-card">
                    <i class="fa-solid fa-shield-halved feature-icon"></i>
                    <h3>Secure Payment</h3>
                    <p style="color: var(--text-light); font-size: 0.9rem;">Pay securely with Paystack, Flutterwave or USSD.</p>
                </div>
                <div class="feature-card">
                    <i class="fa-solid fa-scissors feature-icon"></i>
                    <h3>Authentic Tailoring</h3>
                    <p style="color: var(--text-light); font-size: 0.9rem;">Every piece is stitched by master tailors in Nigeria.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-grid">
                <!-- Brand Column -->
                <div class="footer-col">
                    <span class="footer-logo">LAGOS.FASHION</span>
                    <p class="footer-desc">The premier destination for contemporary African fashion. Redefining luxury through the lens of Lagosian culture.</p>
                    <div class="social-buttons">
                        <a href="#" class="social-btn">IG</a>
                        <a href="#" class="social-btn">X</a>
                        <a href="#" class="social-btn">FB</a>
                    </div>
                </div>
                
                <!-- Shop Column -->
                <div class="footer-col">
                    <h4>SHOP</h4>
                    <div class="footer-links">
                        <a href="#" onclick="app.filterProducts('all'); document.getElementById('shop-section').scrollIntoView()">New Arrivals</a>
                        <a href="#" onclick="app.filterProducts('men'); document.getElementById('shop-section').scrollIntoView()">Men's Collection</a>
                        <a href="#" onclick="app.filterProducts('women'); document.getElementById('shop-section').scrollIntoView()">Women's Collection</a>
                        <a href="#" onclick="app.filterProducts('accessories'); document.getElementById('shop-section').scrollIntoView()">Accessories</a>
                    </div>
                </div>

                <!-- Support Column -->
                <div class="footer-col">
                    <h4>SUPPORT</h4>
                    <div class="footer-links">
                        <a href="#" onclick="app.openOrderTracking()">Order Status</a>
                        <a href="#">Shipping & Returns</a>
                        <a href="#" onclick="app.toggleSizeGuide()">Size Guide</a>
                        <a href="#">Contact Us</a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>© 2025 Lagos Fashion Ltd. All rights reserved.</p>
                <div class="footer-bottom-links">
                    <a href="#">Privacy Policy</a>
                    <a href="#">Terms of Service</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Newsletter Modal -->
    <div id="newsletter-modal" class="newsletter-modal">
        <div class="newsletter-content">
            <span class="close-newsletter" onclick="document.getElementById('newsletter-modal').classList.remove('active')">&times;</span>
            <span style="color: var(--accent); font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase;">Exclusive Access</span>
            <h2 class="font-serif" style="font-size: 2.5rem; margin-top: 1rem; margin-bottom: 1rem;">Join the Inner Circle</h2>
            <p style="color: var(--text-light); margin-bottom: 2rem;">Subscribe to receive updates on new drops and get <strong style="color:black;">10% off</strong> your first order.</p>
            <div class="promo-container" style="justify-content: center;">
                <input type="email" placeholder="Your email address" class="promo-input" style="flex:0 0 60%;">
                <button class="promo-btn">SUBSCRIBE</button>
            </div>
        </div>
    </div>

    <!-- Login Modal (New) -->
    <div id="auth-modal" class="auth-modal">
        <div class="auth-content">
            <button onclick="app.toggleLoginModal()" style="position:absolute; right:1.5rem; top:1.5rem; font-size:1.2rem;"><i class="fa-solid fa-times"></i></button>
            <div class="auth-tabs">
                <div class="auth-tab active">LOGIN</div>
                <div class="auth-tab">REGISTER</div>
            </div>
            <div class="form-group">
                <input type="email" class="form-input" placeholder="Email Address">
            </div>
            <div class="form-group">
                <input type="password" class="form-input" placeholder="Password">
            </div>
            <button class="btn-block" onclick="app.showToast('Logged in successfully!'); app.toggleLoginModal();">SIGN IN</button>
            <p style="text-align:center; margin-top:1rem; font-size:0.8rem; color:#666; cursor:pointer;">Forgot your password?</p>
        </div>
    </div>

    <!-- Wishlist Sidebar (New) -->
    <div id="wishlist-overlay" class="wishlist-overlay" onclick="app.toggleWishlistSidebar()"></div>
    <div id="wishlist-sidebar" class="wishlist-sidebar">
        <div class="cart-header">
            <h2 class="font-serif font-bold" style="font-size: 1.25rem;">Wishlist</h2>
            <button onclick="app.toggleWishlistSidebar()" style="color: var(--text-main); font-size: 1.25rem;">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        <div id="wishlist-items" class="wishlist-items">
            <!-- Items injected via JS -->
        </div>
    </div>

    <!-- Order Tracking Modal (New) -->
    <div id="tracking-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 style="font-weight: 700; font-size: 1.1rem;">Track Your Order</h3>
                <button onclick="document.getElementById('tracking-modal').classList.remove('active')" style="color: #666; font-size: 1.1rem;">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-light); margin-bottom: 1.5rem; font-size: 0.9rem;">Enter your order ID (e.g. LF-2025-88) to see current status.</p>
                <div class="form-group">
                    <input type="text" id="track-id" class="form-input" placeholder="Order ID">
                </div>
                <button onclick="app.trackOrder()" class="btn-block">TRACK ORDER</button>
                <div id="track-result" style="margin-top: 1rem; font-weight: bold; color: var(--success);" class="hidden">
                    Status: <span style="color: var(--text-main);">Processing at Lagos Facility</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Cart Sidebar -->
    <div id="cart-overlay" class="cart-overlay" onclick="app.toggleCart()"></div>
    <div id="cart-sidebar" class="cart-sidebar">
        <div class="cart-header">
            <h2 class="font-serif font-bold" style="font-size: 1.25rem;">Your Bag</h2>
            <button onclick="app.toggleCart()" style="color: var(--text-main); font-size: 1.25rem;">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        
        <div id="cart-items" class="cart-items">
            <!-- Cart items injected here -->
        </div>

        <div class="cart-footer">
            <div class="cart-subtotal">
                <span>Subtotal</span>
                <span id="cart-total">₦0.00</span>
            </div>
            <p style="text-align: center; color: var(--text-light); font-size: 0.75rem; margin-bottom: 1.5rem;">Shipping calculated at checkout.</p>
            <button onclick="app.openCheckout()" id="checkout-btn" disabled class="btn-block">
                PROCEED TO CHECKOUT
            </button>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div id="product-modal" class="modal-overlay" onclick="if(event.target === this) app.closeProductModal()">
        <div class="modal-content product-detail-modal" id="product-modal-content">
            <!-- Content injected via JS -->
        </div>
    </div>

    <!-- Size Guide Modal -->
    <div id="size-guide-modal" class="modal-overlay" onclick="if(event.target === this) app.toggleSizeGuide()">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="font-bold">Size Guide (Inches)</h3>
                <button onclick="app.toggleSizeGuide()"><i class="fa-solid fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p class="text-gray-500 mb-4 text-sm">Our tailoring uses standard Nigerian sizing. For custom fits, please contact us on WhatsApp.</p>
                <table class="size-guide-table">
                    <thead>
                        <tr>
                            <th>Size</th>
                            <th>Chest</th>
                            <th>Waist</th>
                            <th>Length (Top)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>S</td><td>38"</td><td>32"</td><td>30"</td></tr>
                        <tr><td>M</td><td>40"</td><td>34"</td><td>31"</td></tr>
                        <tr><td>L</td><td>42"</td><td>36"</td><td>32"</td></tr>
                        <tr><td>XL</td><td>45"</td><td>39"</td><td>33"</td></tr>
                        <tr><td>XXL</td><td>48"</td><td>42"</td><td>34"</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkout-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 style="font-weight: 700; font-size: 1.1rem;">Secure Checkout</h3>
                <button onclick="app.closeCheckout()" style="color: #666; font-size: 1.1rem;">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            
            <form onsubmit="app.processPayment(event)" class="modal-body">
                
                <div class="promo-container">
                    <input type="text" id="promo-code" class="promo-input" placeholder="Promo Code (e.g. LAGOS10)">
                    <button type="button" class="promo-btn" onclick="app.applyPromo()">APPLY</button>
                </div>

                <div style="background: #fafafa; border: 1px solid #eee; padding: 1.5rem; margin-bottom: 2rem;">
                    <div id="discount-row" class="discount-row hidden" style="display:flex; justify-content:space-between; color: var(--success); margin-bottom: 0.5rem; font-size:0.9rem;">
                        <span>Discount (10%)</span>
                        <span id="discount-amount">-₦0.00</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: var(--text-main); font-weight: 700;">Total to pay</span>
                        <span id="checkout-total" style="color: var(--primary); font-weight: 700; font-size: 1.25rem;">₦0.00</span>
                    </div>
                </div>

                <div class="form-group">
                    <input type="text" required class="form-input" placeholder="Full Name">
                </div>
                <div class="form-group">
                    <input type="email" required class="form-input" placeholder="Email Address">
                </div>
                <div class="form-group">
                    <input type="text" required class="form-input" placeholder="Delivery Address (Lagos, etc.)">
                </div>

                <div class="form-group" style="margin-bottom: 2rem;">
                    <label class="form-label" style="margin-bottom: 0.75rem;">Payment Method</label>
                    <div class="payment-options">
                        <label class="payment-option">
                            <input type="radio" name="payment" value="paystack" checked>
                            <div>
                                <span style="display: block; font-weight: 700; font-size: 0.9rem;">Paystack</span>
                                <span style="display: block; font-size: 0.75rem; color: var(--text-light);">Card, Bank Transfer</span>
                            </div>
                        </label>
                        <label class="payment-option">
                            <input type="radio" name="payment" value="flutterwave">
                            <div>
                                <span style="display: block; font-weight: 700; font-size: 0.9rem;">Flutterwave</span>
                                <span style="display: block; font-size: 0.75rem; color: var(--text-light);">Barter, USSD</span>
                            </div>
                        </label>
                    </div>
                </div>

                <button type="submit" id="pay-btn" class="btn-block">
                    <span>PAY NOW</span>
                    <div id="pay-loader" class="loader hidden"></div>
                </button>
            </form>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="modal-overlay">
        <div style="background: white; padding: 4rem 2rem; text-align: center; max-width: 450px; width: 90%;">
            <div style="margin-bottom: 1.5rem; color: var(--primary);">
                <i class="fa-solid fa-circle-check" style="font-size: 4rem;"></i>
            </div>
            <h2 class="font-serif" style="font-size: 2rem; font-weight: 400; margin-bottom: 1rem; color: var(--text-main);">Order Confirmed</h2>
            <p style="color: var(--text-light); margin-bottom: 3rem; line-height: 1.6;">Thank you for shopping with Lagos Fashion. Your order #LF-2025-88 has been received.</p>
            <button onclick="window.location.reload()" class="btn-block">
                CONTINUE SHOPPING
            </button>
        </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast">Item added to bag</div>

    <script>
        // --- Mock Data with Descriptions & Ratings ---
        const products = [
            { id: 1, name: "The Lekki Royal Agbada", price: 45000, category: "men", image: "https://images.unsplash.com/photo-1571212515416-f633393b4a20?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80", stock: 4, isNew: true, rating: 4.8, reviews: 24, description: "A majestic three-piece Agbada set woven from premium cotton, featuring intricate handcrafted embroidery." },
            { id: 2, name: "Ibadan Sunset Maxi", price: 22500, category: "women", image: "https://images.unsplash.com/photo-1563178406-4cdc2923acce?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80", stock: 12, isNew: false, rating: 4.5, reviews: 18, description: "Flowing maxi dress inspired by the warm hues of an Ibadan sunset. Made from breathable Ankara fabric." },
            { id: 3, name: "Abuja Executive Kaftan", price: 32000, category: "men", image: "https://images.unsplash.com/photo-1534030347209-7147fd9e7b1a?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80", stock: 8, isNew: false, rating: 4.9, reviews: 32, description: "Modern tailored Kaftan set for the contemporary man. Features clean lines and subtle detailing." },
            { id: 4, name: "Yaba Market Tote", price: 8500, category: "accessories", image: "https://images.unsplash.com/photo-1590874103328-eac38a683ce7?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80", stock: 25, isNew: true, rating: 4.2, reviews: 8, description: "Durable and stylish tote bag made from recycled materials. A vibrant accessory perfect for daily errands." },
            { id: 5, name: "Gold Fulani Hoops", price: 12000, category: "accessories", image: "https://images.unsplash.com/photo-1611591437281-460bfbe1220a?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80", stock: 5, isNew: false, rating: 5.0, reviews: 45, description: "Traditional Fulani-style twisted hoop earrings plated in 18k gold. A timeless statement piece." },
            { id: 6, name: "Enugu Adire Set", price: 28000, category: "women", image: "https://images.unsplash.com/photo-1589465885857-44ed45993466?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80", stock: 2, isNew: false, rating: 4.7, reviews: 12, description: "Two-piece set featuring authentic, hand-dyed Adire textile from Enugu. Each piece is unique." },
            { id: 7, name: "Calabar Coral Beads", price: 15000, category: "accessories", image: "https://images.unsplash.com/photo-1606293926075-69a00dbfde81?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80", stock: 10, isNew: false, rating: 4.6, reviews: 15, description: "Multi-layered genuine coral bead necklace, a symbol of royalty and heritage." },
            { id: 8, name: "Delta Senator Suit", price: 38000, category: "men", image: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-1.2.1&auto=format&fit=crop&w=600&q=80", stock: 6, isNew: true, rating: 4.8, reviews: 29, description: "Sharp and sophisticated Senator style suit in a rich navy blue. Tailored fit for a commanding presence." }
        ];

        // --- Application Logic ---
        const app = {
            cart: [],
            wishlist: [],
            recentViewed: [],
            currentCategory: 'all',
            currentSort: 'default',
            searchQuery: '',
            discountApplied: false,
            asoEbiActive: false,
            currency: 'NGN',
            rates: { NGN: 1, USD: 0.0013, GBP: 0.0010 },
            symbols: { NGN: '₦', USD: '$', GBP: '£' },
            
            init: function() {
                this.checkCookieConsent();
                this.renderProducts();
                this.updateCartIcon();
                this.loadWishlist();
                this.loadRecent();
                
                // Navbar scroll effect
                window.addEventListener('scroll', () => {
                    const nav = document.getElementById('navbar');
                    const backToTop = document.getElementById('back-to-top');
                    
                    if(window.scrollY > 50) nav.classList.add('scrolled');
                    else nav.classList.remove('scrolled');

                    if(window.scrollY > 500) backToTop.classList.add('visible');
                    else backToTop.classList.remove('visible');
                });

                // Newsletter Popup Trigger (Once per session for simplicity)
                if(!sessionStorage.getItem('newsletterShown')) {
                    setTimeout(() => {
                        document.getElementById('newsletter-modal').classList.add('active');
                        sessionStorage.setItem('newsletterShown', 'true');
                    }, 5000);
                }

                // Inventory Simulation
                setInterval(() => {
                    const randomId = Math.floor(Math.random() * products.length) + 1;
                    const product = products.find(p => p.id === randomId);
                    if(product && product.stock > 0) {
                        product.stock--;
                        this.renderProducts();
                    }
                }, 30000);
            },

            checkCookieConsent: function() {
                if(!localStorage.getItem('cookieConsent')) {
                    setTimeout(() => {
                        document.getElementById('cookie-banner').classList.add('show');
                    }, 2000);
                }
            },

            acceptCookies: function() {
                localStorage.setItem('cookieConsent', 'true');
                document.getElementById('cookie-banner').classList.remove('show');
            },

            toggleLoginModal: function() {
                const modal = document.getElementById('auth-modal');
                if (modal.classList.contains('active')) modal.classList.remove('active');
                else modal.classList.add('active');
            },

            formatCurrency: function(amount) {
                const converted = Math.ceil(amount * this.rates[this.currency]);
                return this.symbols[this.currency] + converted.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            },

            switchCurrency: function(curr) {
                this.currency = curr;
                this.renderProducts();
                this.updateCartUI(); 
                this.renderRecentViewed(); // Update recent prices too
            },

            renderStars: function(rating) {
                let stars = '';
                for(let i = 1; i <= 5; i++) {
                    if(i <= rating) stars += '<i class="fa-solid fa-star"></i>';
                    else if(i - 0.5 <= rating) stars += '<i class="fa-solid fa-star-half-stroke"></i>';
                    else stars += '<i class="fa-regular fa-star"></i>';
                }
                return stars;
            },

            toggleSearch: function() {
                const container = document.getElementById('search-container');
                const input = document.getElementById('search-input');
                container.classList.toggle('active');
                if(container.classList.contains('active')) {
                    input.focus();
                } else {
                    input.value = '';
                    this.handleSearch('');
                }
            },

            handleSearch: function(query) {
                this.searchQuery = query.toLowerCase();
                this.renderProducts();
            },

            handleSort: function(sortType) {
                this.currentSort = sortType;
                this.renderProducts();
            },

            getFilteredAndSortedProducts: function() {
                let filtered = this.currentCategory === 'all' 
                    ? [...products] 
                    : products.filter(p => p.category === this.currentCategory);
                
                if (this.searchQuery) {
                    filtered = filtered.filter(p => 
                        p.name.toLowerCase().includes(this.searchQuery)
                    );
                }

                switch(this.currentSort) {
                    case 'price-asc':
                        return filtered.sort((a, b) => a.price - b.price);
                    case 'price-desc':
                        return filtered.sort((a, b) => b.price - a.price);
                    default:
                        return filtered;
                }
            },

            toggleWishlist: function(id) {
                const index = this.wishlist.indexOf(id);
                if (index === -1) {
                    this.wishlist.push(id);
                    this.showToast("Added to wishlist");
                } else {
                    this.wishlist.splice(index, 1);
                    this.showToast("Removed from wishlist");
                }
                this.saveWishlist();
                this.renderProducts();
                // Refresh sidebar if open
                if(document.getElementById('wishlist-sidebar').classList.contains('open')) {
                    this.renderWishlistItems();
                }
            },

            loadWishlist: function() {
                const saved = localStorage.getItem('lagosWishlist');
                if (saved) this.wishlist = JSON.parse(saved);
            },

            saveWishlist: function() {
                localStorage.setItem('lagosWishlist', JSON.stringify(this.wishlist));
            },

            toggleWishlistSidebar: function() {
                const sidebar = document.getElementById('wishlist-sidebar');
                const overlay = document.getElementById('wishlist-overlay');
                
                if (sidebar.classList.contains('open')) {
                    sidebar.classList.remove('open');
                    overlay.classList.remove('open');
                } else {
                    this.renderWishlistItems();
                    sidebar.classList.add('open');
                    overlay.classList.add('open');
                }
            },

            renderWishlistItems: function() {
                const container = document.getElementById('wishlist-items');
                container.innerHTML = '';
                
                if(this.wishlist.length === 0) {
                    container.innerHTML = '<div class="empty-cart-msg">Your wishlist is empty.</div>';
                    return;
                }

                this.wishlist.forEach(id => {
                    const item = products.find(p => p.id === id);
                    if(item) {
                        const el = document.createElement('div');
                        el.className = "wishlist-item";
                        el.innerHTML = `
                            <div class="cart-item-img"><img src="${item.image}"></div>
                            <div class="cart-item-details">
                                <h3>${item.name}</h3>
                                <p>${this.formatCurrency(item.price)}</p>
                                <div style="margin-top:auto">
                                    <button onclick="app.addToCart(${item.id}); app.toggleWishlistSidebar()" style="text-decoration:underline; font-size:0.8rem;">Add to Bag</button>
                                    <button onclick="app.toggleWishlist(${item.id})" class="remove-btn" style="margin-left:1rem;">Remove</button>
                                </div>
                            </div>
                        `;
                        container.appendChild(el);
                    }
                });
            },

            // --- Recently Viewed Logic ---
            addToRecent: function(id) {
                // Remove if exists then add to front
                this.recentViewed = this.recentViewed.filter(itemId => itemId !== id);
                this.recentViewed.unshift(id);
                // Keep max 5
                if(this.recentViewed.length > 5) this.recentViewed.pop();
                localStorage.setItem('lagosRecent', JSON.stringify(this.recentViewed));
                this.renderRecentViewed();
            },

            loadRecent: function() {
                const saved = localStorage.getItem('lagosRecent');
                if(saved) this.recentViewed = JSON.parse(saved);
                this.renderRecentViewed();
            },

            renderRecentViewed: function() {
                const container = document.getElementById('recent-grid');
                container.innerHTML = '';
                if(this.recentViewed.length === 0) {
                    document.getElementById('recently-viewed').style.display = 'none';
                    return;
                }
                document.getElementById('recently-viewed').style.display = 'block';
                
                this.recentViewed.forEach(id => {
                    const product = products.find(p => p.id === id);
                    if(product) {
                        const card = document.createElement('div');
                        card.className = "recent-card";
                        card.onclick = () => app.openProductModal(product.id);
                        card.innerHTML = `
                            <img src="${product.image}" class="recent-img">
                            <div class="recent-name">${product.name}</div>
                            <div class="recent-price">${this.formatCurrency(product.price)}</div>
                        `;
                        container.appendChild(card);
                    }
                });
            },

            openOrderTracking: function() {
                document.getElementById('tracking-modal').classList.add('active');
            },

            trackOrder: function() {
                const id = document.getElementById('track-id').value;
                const result = document.getElementById('track-result');
                if(id.length > 3) {
                    result.classList.remove('hidden');
                } else {
                    this.showToast("Please enter a valid Order ID");
                }
            },

            openProductModal: function(id) {
                const product = products.find(p => p.id === id);
                const cartItem = this.cart.find(c => c.id === id);
                const displayStock = product.stock - (cartItem ? cartItem.qty : 0);
                const isSoldOut = displayStock <= 0;
                this.asoEbiActive = false;
                
                // Track view
                this.addToRecent(id);

                const related = products.filter(p => p.category === product.category && p.id !== product.id)
                                        .sort(() => 0.5 - Math.random())
                                        .slice(0, 2);

                const content = document.getElementById('product-modal-content');
                content.innerHTML = `
                    <div class="product-detail-img">
                        <img src="${product.image}" alt="${product.name}">
                    </div>
                    <div class="product-detail-info">
                        <div class="pd-header">
                            <h2 class="pd-title">${product.name}</h2>
                            <button onclick="app.closeProductModal()" style="font-size: 1.5rem;"><i class="fa-solid fa-times"></i></button>
                        </div>
                        <div class="stars" style="margin-bottom: 0.5rem;">${this.renderStars(product.rating)} <span style="color:var(--text-light); font-size: 0.8rem; margin-left: 0.5rem;">(${product.reviews} reviews)</span></div>
                        <p class="pd-price">${this.formatCurrency(product.price)}</p>
                        
                        <div class="pd-meta">
                            <span class="pd-meta-item cursor-pointer hover:text-black" onclick="app.toggleSizeGuide()"><i class="fa-solid fa-ruler"></i> Size Guide</span>
                            <span class="pd-meta-item"><i class="fa-solid fa-truck"></i> Free Delivery</span>
                        </div>

                        <p class="pd-desc">${product.description}</p>
                        
                        <div style="margin-top: auto;">
                             <button id="modal-add-btn" onclick="app.addToCart(${product.id}); app.closeProductModal()" 
                                ${isSoldOut ? 'disabled' : ''}
                                class="btn-block">
                                ${isSoldOut ? 'Out of Stock' : 'ADD TO BAG'}
                            </button>
                             <p class="stock-text" style="text-align: left;">${displayStock > 0 && displayStock < 5 ? `Only ${displayStock} left` : ''}</p>
                        </div>

                        <div class="related-section">
                            <h4 class="related-title">You May Also Like</h4>
                            <div class="related-grid">
                                ${related.map(p => `
                                    <div class="related-card" onclick="app.openProductModal(${p.id})">
                                        <div class="related-img"><img src="${p.image}"></div>
                                        <div>
                                            <div class="related-name">${p.name}</div>
                                            <div class="related-price">${this.formatCurrency(p.price)}</div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                document.getElementById('product-modal').classList.add('active');
            },

            closeProductModal: function() {
                document.getElementById('product-modal').classList.remove('active');
            },

            toggleSizeGuide: function() {
                const modal = document.getElementById('size-guide-modal');
                modal.classList.toggle('active');
            },

            // --- Checkout Logic ---
            applyPromo: function() {
                const code = document.getElementById('promo-code').value.toUpperCase().trim();
                const total = this.cart.reduce((acc, item) => acc + (item.price * item.qty), 0);
                
                if (code === 'LAGOS10') {
                    this.discountApplied = true;
                    this.showToast("Promo applied!");
                    this.updateCheckoutTotal(total);
                } else {
                    this.showToast("Invalid promo code");
                    this.discountApplied = false;
                    this.updateCheckoutTotal(total);
                }
            },

            updateCheckoutTotal: function(subtotal) {
                const discountEl = document.getElementById('discount-row');
                const discountAmountEl = document.getElementById('discount-amount');
                const totalEl = document.getElementById('checkout-total');
                
                if (this.discountApplied) {
                    const discount = subtotal * 0.1;
                    const final = subtotal - discount;
                    discountEl.classList.remove('hidden');
                    discountAmountEl.innerText = '-' + this.formatCurrency(discount);
                    totalEl.innerText = this.formatCurrency(final);
                } else {
                    discountEl.classList.add('hidden');
                    totalEl.innerText = this.formatCurrency(subtotal);
                }
            },

            subscribeNewsletter: function(e) {
                e.preventDefault();
                const input = e.target.querySelector('input');
                if(input.value) {
                    this.showToast("Subscribed successfully");
                    input.value = '';
                }
            },

            filterProducts: function(category) {
                this.currentCategory = category;
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.toggle('active', link.dataset.cat === category);
                });
                this.renderProducts();
            },

            renderProducts: function() {
                const grid = document.getElementById('product-grid');
                grid.innerHTML = '';
                const finalProducts = this.getFilteredAndSortedProducts();

                if (finalProducts.length === 0) {
                    grid.innerHTML = '<p class="text-center" style="grid-column: 1/-1; color: var(--text-light); padding: 4rem;">No products found.</p>';
                    return;
                }

                finalProducts.forEach(product => {
                    const cartItem = this.cart.find(c => c.id === product.id);
                    const qtyInCart = cartItem ? cartItem.qty : 0;
                    const displayStock = product.stock - qtyInCart;
                    const isSoldOut = displayStock <= 0;
                    const isWishlisted = this.wishlist.includes(product.id);

                    const card = document.createElement('div');
                    card.className = "product-card";
                    card.innerHTML = `
                        <div class="product-image-wrapper">
                            <button class="wishlist-btn ${isWishlisted ? 'active' : ''}" onclick="event.stopPropagation(); app.toggleWishlist(${product.id})">
                                <i class="${isWishlisted ? 'fa-solid' : 'fa-regular'} fa-heart"></i>
                            </button>
                            <img src="${product.image}" alt="${product.name}" onclick="app.openProductModal(${product.id})">
                            ${product.isNew ? '<span class="badge badge-new">New</span>' : ''}
                            ${displayStock <= 3 && displayStock > 0 ? '<span class="badge badge-low animate-pulse">Low Stock</span>' : ''}
                            ${isSoldOut ? '<div class="sold-out-overlay"><span class="sold-out-text">Sold Out</span></div>' : ''}
                        </div>
                        <div class="product-info">
                            <div>
                                <h3 class="product-title" onclick="app.openProductModal(${product.id})">${product.name}</h3>
                                <div class="stars stars-small">${this.renderStars(product.rating)}</div>
                                <p class="product-cat">${product.category}</p>
                            </div>
                            <p class="product-price">${this.formatCurrency(product.price)}</p>
                        </div>
                        <div>
                            <button onclick="event.preventDefault(); app.addToCart(${product.id})" 
                                ${isSoldOut ? 'disabled' : ''}
                                class="btn-add-cart">
                                ${isSoldOut ? 'Out of Stock' : 'ADD TO BAG'}
                            </button>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            },

            addToCart: function(id) {
                const product = products.find(p => p.id === id);
                const cartItem = this.cart.find(c => c.id === id);
                const currentQty = cartItem ? cartItem.qty : 0;
                
                if(currentQty >= product.stock) {
                    this.showToast("Sorry, no more stock available!");
                    return;
                }

                if (cartItem) cartItem.qty++;
                else this.cart.push({ ...product, qty: 1 });

                this.updateCartIcon();
                this.renderCartItems();
                this.renderProducts();
                this.showToast("Added to bag");
                
                if(this.cart.length === 1 && currentQty === 0) {
                    const sidebar = document.getElementById('cart-sidebar');
                    if(!sidebar.classList.contains('open')) this.toggleCart();
                }
            },

            removeFromCart: function(id) {
                this.cart = this.cart.filter(item => item.id !== id);
                this.updateCartIcon();
                this.renderCartItems();
                this.renderProducts();
            },

            updateQty: function(id, change) {
                const item = this.cart.find(c => c.id === id);
                const product = products.find(p => p.id === id);
                if(!item) return;

                if (change > 0) {
                    if (item.qty < product.stock) item.qty++;
                    else this.showToast("Max stock reached");
                } else {
                    item.qty--;
                    if (item.qty === 0) return this.removeFromCart(id);
                }
                
                this.updateCartIcon();
                this.renderCartItems();
                this.renderProducts();
            },

            toggleCart: function() {
                const sidebar = document.getElementById('cart-sidebar');
                const overlay = document.getElementById('cart-overlay');
                const body = document.body;

                sidebar.classList.toggle('open');
                overlay.classList.toggle('open');
                
                if (sidebar.classList.contains('open')) {
                    body.style.overflow = 'hidden';
                    this.renderCartItems();
                } else {
                    body.style.overflow = '';
                }
            },

            renderCartItems: function() {
                const container = document.getElementById('cart-items');
                const totalEl = document.getElementById('cart-total');
                const checkoutBtn = document.getElementById('checkout-btn');
                
                container.innerHTML = '';
                let total = 0;

                if (this.cart.length === 0) {
                    container.innerHTML = `
                        <div class="empty-cart-msg">
                            <i class="fa-solid fa-basket-shopping" style="font-size: 3rem; color: #eee; margin-bottom: 1rem;"></i>
                            <p>Your bag is empty.</p>
                            <button onclick="app.toggleCart()" style="margin-top: 1rem; color: var(--primary); font-weight: 700; text-decoration: underline;">Start Shopping</button>
                        </div>
                    `;
                    checkoutBtn.disabled = true;
                } else {
                    this.cart.forEach(item => {
                        total += item.price * item.qty;
                        
                        const el = document.createElement('div');
                        el.className = "cart-item";
                        el.innerHTML = `
                            <div class="cart-item-img">
                                <img src="${item.image}" alt="${item.name}">
                            </div>
                            <div class="cart-item-details">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 0.2rem;">
                                    <h3 style="font-size: 0.9rem; font-weight: 700;">${item.name}</h3>
                                    <p style="font-weight: 700; font-size: 0.9rem;">${this.formatCurrency(item.price)}</p>
                                </div>
                                <p style="font-size: 0.75rem; color: var(--text-light); text-transform: capitalize; margin-bottom: auto;">${item.category}</p>
                                
                                <div class="qty-controls">
                                    <button onclick="app.updateQty(${item.id}, -1)" class="qty-btn">-</button>
                                    <span class="qty-val">${item.qty}</span>
                                    <button onclick="app.updateQty(${item.id}, 1)" class="qty-btn">+</button>
                                </div>
                                <button onclick="app.removeFromCart(${item.id})" class="remove-btn">Remove</button>
                            </div>
                        `;
                        container.appendChild(el);
                    });
                    checkoutBtn.disabled = false;
                }
                totalEl.innerText = this.formatCurrency(total);
            },
            
            updateCartUI: function() {
                 const totalEl = document.getElementById('cart-total');
                 if(totalEl) {
                     const total = this.cart.reduce((acc, item) => acc + (item.price * item.qty), 0);
                     totalEl.innerText = this.formatCurrency(total);
                 }
            },

            updateCartIcon: function() {
                const count = this.cart.reduce((acc, item) => acc + item.qty, 0);
                const badge = document.getElementById('cart-count');
                badge.innerText = count;
                if (count > 0) badge.classList.add('active');
                else badge.classList.remove('active');
            },

            showToast: function(message) {
                const toast = document.getElementById("toast");
                toast.innerText = message;
                toast.classList.add("show");
                setTimeout(function(){ toast.classList.remove("show"); }, 3000);
            },

            openCheckout: function() {
                this.toggleCart();
                document.getElementById('checkout-modal').classList.add('active');
                
                // Reset Promo
                this.discountApplied = false;
                document.getElementById('promo-code').value = '';
                
                const total = this.cart.reduce((acc, item) => acc + (item.price * item.qty), 0);
                this.updateCheckoutTotal(total);
            },

            closeCheckout: function() {
                document.getElementById('checkout-modal').classList.remove('active');
            },

            processPayment: function(e) {
                e.preventDefault();
                const btn = document.getElementById('pay-btn');
                const loader = document.getElementById('pay-loader');
                const btnText = btn.querySelector('span');
                
                btn.disabled = true;
                btn.style.opacity = '0.75';
                loader.classList.remove('hidden');
                btnText.innerText = "PROCESSING...";

                setTimeout(() => {
                    this.closeCheckout();
                    document.getElementById('success-modal').classList.add('active');
                    this.cart = [];
                    this.updateCartIcon();
                    btn.disabled = false;
                    btn.style.opacity = '1';
                    loader.classList.add('hidden');
                    btnText.innerText = "PAY NOW";
                    
                    products.forEach(p => {
                        const pInCart = this.cart.find(c => c.id === p.id);
                        if(pInCart) p.stock -= pInCart.qty;
                    });
                    this.renderProducts();
                }, 2000);
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });
    </script>
</body>
</html>
